<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{% block title %}Chalk Admin{% endblock %} - Chalk Console</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/htmx.org@2.0.4"></script>
    <style>
        /* ── Reset ── */
        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

        /* ── Design Tokens ── */
        :root {
            --c-primary: #0D9488;
            --c-primary-hover: #0F766E;
            --c-primary-light: #CCFBF1;
            --c-accent: #F59E0B;
            --c-danger: #EF4444;
            --c-danger-light: #FEE2E2;
            --c-sidebar: #1E293B;
            --c-sidebar-hover: #334155;
            --c-sidebar-active: #0D9488;
            --c-bg: #F8FAFC;
            --c-surface: #FFFFFF;
            --c-border: #E2E8F0;
            --c-text: #334155;
            --c-text-muted: #94A3B8;
            --c-text-heading: #1E293B;
            --c-success: #22C55E;
            --c-success-bg: #F0FDF4;
            --c-danger-bg: #FEF2F2;
            --c-warning-bg: #FFFBEB;
            --c-warning: #F59E0B;
            --font: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            --shadow-sm: 0 1px 2px rgba(0,0,0,0.05);
            --shadow-md: 0 4px 6px -1px rgba(0,0,0,0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0,0,0,0.1);
            --radius-sm: 4px;
            --radius-md: 8px;
            --radius-lg: 12px;
        }

        /* ── Base ── */
        body { font-family: var(--font); color: var(--c-text); background: var(--c-bg); line-height: 1.6; font-size: 0.9375rem; }
        a { color: var(--c-primary); text-decoration: none; }
        a:hover { text-decoration: underline; }
        h1, h2, h3, h4, h5, h6 { color: var(--c-text-heading); font-weight: 600; line-height: 1.3; margin-bottom: 0.75rem; }
        h1 { font-size: 1.75rem; }
        h2 { font-size: 1.25rem; }
        h3 { font-size: 1.1rem; }
        p { margin-bottom: 1rem; }
        strong { font-weight: 600; }
        code { background: var(--c-bg); padding: 0.125rem 0.375rem; border-radius: var(--radius-sm); font-size: 0.875rem; }
        hr { border: none; border-top: 1px solid var(--c-border); margin: 1.5rem 0; }

        /* ── Layout ── */
        .sidebar { position: fixed; top: 0; left: 0; bottom: 0; width: 260px; background: var(--c-sidebar); color: #CBD5E1; display: flex; flex-direction: column; z-index: 100; transition: transform 0.2s ease; }
        .sidebar-brand { padding: 1.25rem 1.5rem; font-size: 1.5rem; font-weight: 700; color: #FFFFFF; border-bottom: 1px solid rgba(255,255,255,0.1); }
        .sidebar-brand span { color: var(--c-primary); }
        .sidebar-nav { flex: 1; overflow-y: auto; padding: 0.75rem 0; }
        .sidebar-section { padding: 0.5rem 1.5rem 0.25rem; font-size: 0.6875rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; color: #64748B; margin-top: 0.5rem; }
        .sidebar-link { display: flex; align-items: center; gap: 0.75rem; padding: 0.5rem 1.5rem; color: #CBD5E1; text-decoration: none; font-size: 0.875rem; transition: all 0.15s; border-left: 3px solid transparent; }
        .sidebar-link:hover { background: var(--c-sidebar-hover); color: #FFFFFF; text-decoration: none; }
        .sidebar-link.active { background: rgba(13,148,136,0.15); color: var(--c-primary); border-left-color: var(--c-primary); font-weight: 500; }
        .sidebar-link svg { width: 18px; height: 18px; flex-shrink: 0; opacity: 0.7; }
        .sidebar-link.active svg { opacity: 1; }
        .sidebar-link.disabled { opacity: 0.35; pointer-events: none; }
        .sidebar-badge { font-size: 0.625rem; padding: 0.1rem 0.4rem; border-radius: var(--radius-sm); background: #475569; color: #94A3B8; margin-left: auto; }
        .sidebar-footer { padding: 1rem 1.5rem; border-top: 1px solid rgba(255,255,255,0.1); }
        .sidebar-footer form { margin: 0; }
        .sidebar-footer button { width: 100%; background: transparent; border: 1px solid rgba(255,255,255,0.2); color: #CBD5E1; padding: 0.5rem; border-radius: var(--radius-md); cursor: pointer; font-family: var(--font); font-size: 0.875rem; display: flex; align-items: center; justify-content: center; gap: 0.5rem; transition: all 0.15s; }
        .sidebar-footer button:hover { background: rgba(255,255,255,0.1); color: #FFFFFF; }

        .sidebar-overlay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.5); z-index: 99; }

        .main-wrapper { margin-left: 260px; min-height: 100vh; display: flex; flex-direction: column; }
        .topbar { background: var(--c-surface); border-bottom: 1px solid var(--c-border); padding: 0.75rem 2rem; display: flex; align-items: center; gap: 1rem; position: sticky; top: 0; z-index: 50; }
        .topbar-hamburger { display: none; background: none; border: none; cursor: pointer; padding: 0.25rem; color: var(--c-text); }
        .topbar-hamburger svg { width: 24px; height: 24px; }
        .topbar-title { font-size: 1rem; font-weight: 600; color: var(--c-text-heading); }
        .content { flex: 1; padding: 2rem; max-width: 1200px; width: 100%; }
        footer { text-align: center; padding: 1rem 2rem; color: var(--c-text-muted); font-size: 0.8125rem; border-top: 1px solid var(--c-border); }

        /* ── Stat Cards ── */
        .stat-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 1rem; margin-bottom: 1.5rem; }
        .stat-card { background: var(--c-surface); border: 1px solid var(--c-border); border-left: 4px solid var(--c-primary); border-radius: var(--radius-md); padding: 1.25rem; box-shadow: var(--shadow-sm); }
        .stat-card h2 { font-size: 1.75rem; margin-bottom: 0.125rem; color: var(--c-text-heading); }
        .stat-card p { margin: 0; color: var(--c-text-muted); font-size: 0.8125rem; }

        /* ── Tables ── */
        table { width: 100%; border-collapse: collapse; }
        .table-container { background: var(--c-surface); border: 1px solid var(--c-border); border-radius: var(--radius-md); overflow: hidden; box-shadow: var(--shadow-sm); margin-bottom: 1.5rem; }
        .table-container table { margin: 0; }
        thead th { background: var(--c-bg); padding: 0.75rem 1rem; text-align: left; font-size: 0.75rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; color: var(--c-text-muted); border-bottom: 1px solid var(--c-border); }
        tbody td { padding: 0.75rem 1rem; border-bottom: 1px solid var(--c-border); font-size: 0.875rem; }
        tbody tr:last-child td { border-bottom: none; }
        tbody tr:hover { background: #F1F5F9; }

        /* ── Cards / Articles ── */
        article, section > article { background: var(--c-surface); border: 1px solid var(--c-border); border-radius: var(--radius-md); padding: 1.5rem; box-shadow: var(--shadow-sm); margin-bottom: 1.5rem; }
        section { margin-bottom: 1.5rem; }

        /* ── Buttons ── */
        button, input[type="submit"], .btn { font-family: var(--font); font-size: 0.875rem; padding: 0.5rem 1.25rem; border-radius: var(--radius-md); cursor: pointer; font-weight: 500; transition: all 0.15s; border: none; display: inline-flex; align-items: center; gap: 0.5rem; }
        button[type="submit"], input[type="submit"], .btn-primary { background: var(--c-primary); color: #FFFFFF; }
        button[type="submit"]:hover, input[type="submit"]:hover, .btn-primary:hover { background: var(--c-primary-hover); }
        .outline, .btn-secondary { background: transparent; border: 1px solid var(--c-border); color: var(--c-text); }
        .outline:hover, .btn-secondary:hover { background: var(--c-bg); border-color: var(--c-text-muted); }
        .btn-danger { background: var(--c-danger); color: #FFFFFF; }
        .btn-danger:hover { background: #DC2626; }

        /* ── Forms ── */
        label { display: block; font-size: 0.875rem; font-weight: 500; margin-bottom: 0.375rem; color: var(--c-text-heading); }
        input[type="text"], input[type="password"], input[type="email"], input[type="search"], input[type="url"],
        input[type="number"], select, textarea {
            width: 100%; padding: 0.5rem 0.75rem; border: 1px solid var(--c-border); border-radius: var(--radius-md);
            font-family: var(--font); font-size: 0.875rem; color: var(--c-text); background: var(--c-surface);
            transition: border-color 0.15s, box-shadow 0.15s;
        }
        input:focus, select:focus, textarea:focus { outline: none; border-color: var(--c-primary); box-shadow: 0 0 0 3px rgba(13,148,136,0.15); }
        fieldset { border: 1px solid var(--c-border); border-radius: var(--radius-md); padding: 1rem 1.25rem; margin-bottom: 1rem; }
        legend { font-weight: 600; font-size: 0.875rem; padding: 0 0.25rem; }

        /* ── Status Badges ── */
        .status-badge { display: inline-block; padding: 0.2rem 0.625rem; border-radius: 9999px; font-size: 0.75rem; font-weight: 500; }
        .status-completed, .status-synced { background: var(--c-success-bg); color: #16A34A; }
        .status-failed, .status-error { background: var(--c-danger-bg); color: var(--c-danger); }
        .status-running { background: var(--c-warning-bg); color: #D97706; }
        .status-pending { background: var(--c-bg); color: var(--c-text-muted); border: 1px solid var(--c-border); }
        .status-suspended { background: var(--c-danger-bg); color: var(--c-danger); }

        /* ── Grid (replaces Pico .grid) ── */
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem; }

        /* ── HTMX Indicator ── */
        .htmx-indicator { display: none; }
        .htmx-request .htmx-indicator, .htmx-request.htmx-indicator { display: inline-block; }
        .spinner { width: 16px; height: 16px; border: 2px solid var(--c-border); border-top-color: var(--c-primary); border-radius: 50%; animation: spin 0.6s linear infinite; display: inline-block; vertical-align: middle; margin-left: 0.5rem; }
        @keyframes spin { to { transform: rotate(360deg); } }

        /* ── Responsive ── */
        @media (max-width: 768px) {
            .sidebar { transform: translateX(-100%); }
            .sidebar.open { transform: translateX(0); }
            .sidebar-overlay.open { display: block; }
            .main-wrapper { margin-left: 0; }
            .topbar-hamburger { display: block; }
            .content { padding: 1rem; }
            .topbar { padding: 0.75rem 1rem; }
            .stat-grid { grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); }
        }
    </style>
</head>
<body>
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-brand"><span>C</span>halk</div>
        <nav class="sidebar-nav">
            <a href="/" class="sidebar-link{% if active_page == "dashboard" %} active{% endif %}">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7" rx="1"/><rect x="14" y="3" width="7" height="7" rx="1"/><rect x="3" y="14" width="7" height="7" rx="1"/><rect x="14" y="14" width="7" height="7" rx="1"/></svg>
                Dashboard
            </a>

            <div class="sidebar-section">Data</div>
            <a href="/sync" class="sidebar-link{% if active_page == "sync" %} active{% endif %}">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M23 4v6h-6"/><path d="M1 20v-6h6"/><path d="M3.51 9a9 9 0 0114.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0020.49 15"/></svg>
                SIS Sync
            </a>
            <a href="/users" class="sidebar-link{% if active_page == "users" %} active{% endif %}">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 00-3-3.87"/><path d="M16 3.13a4 4 0 010 7.75"/></svg>
                Users
            </a>
            <a href="/google-sync" class="sidebar-link{% if active_page == "google_sync" %} active{% endif %}">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 10h-1.26A8 8 0 109 20h9a5 5 0 000-10z"/></svg>
                Google Sync
            </a>

            <div class="sidebar-section">Configuration</div>
            <a href="/settings" class="sidebar-link{% if active_page == "settings" %} active{% endif %}">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-4 0v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06A1.65 1.65 0 004.68 15a1.65 1.65 0 00-1.51-1H3a2 2 0 010-4h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 012.83-2.83l.06.06A1.65 1.65 0 009 4.68a1.65 1.65 0 001-1.51V3a2 2 0 014 0v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 2.83l-.06.06A1.65 1.65 0 0019.4 9a1.65 1.65 0 001.51 1H21a2 2 0 010 4h-.09a1.65 1.65 0 00-1.51 1z"/></svg>
                Settings
            </a>
            <a href="/identity" class="sidebar-link{% if active_page == "identity" %} active{% endif %}">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
                Identity
            </a>

            <div class="sidebar-section">Tools</div>
            <a href="/migration" class="sidebar-link{% if active_page == "migration" %} active{% endif %}">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 12h14"/><path d="M12 5l7 7-7 7"/></svg>
                Migration
            </a>
            <a href="/settings/audit-log" class="sidebar-link{% if active_page == "audit_log" %} active{% endif %}">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M16 4h2a2 2 0 012 2v14a2 2 0 01-2 2H6a2 2 0 01-2-2V6a2 2 0 012-2h2"/><rect x="8" y="2" width="8" height="4" rx="1"/><line x1="9" y1="12" x2="15" y2="12"/><line x1="9" y1="16" x2="15" y2="16"/></svg>
                Audit Log
            </a>
            <a href="#" class="sidebar-link disabled">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 2L3 6v14a2 2 0 002 2h14a2 2 0 002-2V6l-3-4z"/><line x1="3" y1="6" x2="21" y2="6"/><path d="M16 10a4 4 0 01-8 0"/></svg>
                Marketplace
                <span class="sidebar-badge">Soon</span>
            </a>
        </nav>
        <div class="sidebar-footer">
            <form method="post" action="/logout">
                <button type="submit">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16"><path d="M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>
                    Logout
                </button>
            </form>
        </div>
    </aside>
    <div class="main-wrapper">
        <header class="topbar">
            <button class="topbar-hamburger" onclick="toggleSidebar()" aria-label="Toggle menu">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
            </button>
            <span class="topbar-title">Chalk Admin</span>
        </header>
        <main class="content">
            {% block content %}{% endblock %}
        </main>
        <footer>
            <p>Chalk Admin Console v1.0.0</p>
        </footer>
    </div>
    <script>
        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('open');
            document.getElementById('sidebarOverlay').classList.toggle('open');
        }
    </script>
</body>
</html>
